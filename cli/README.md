# CLI

```
cd cli/
cargo build --bin enft-cli
target/debug/enft-cli -h

# creator generates msk

target/debug/enft-cli generate-master-key

Master sk: a1466cfa0e01b2b2a40663d18ce5651459444580ac4b3cd36a403ba0a46cb76eda010994c94858edc4811570f8893af4

# creator generates encryption key (AES key)

target/debug/enft-cli generate-encryption-key

Encryption sk: 2fd7a46d6c4955630c91f6960b4cfc02f07254d0f41feccf03f67c3e2f07576f
Encryption pk: 86e2dc6d7c0e0ee4744c7625bedfe8462b8e63262f41fa6403316f90a10e69466f53ef4f9dd5bcca9a460b797bfd8892

# generate another pair, assume this is for buyer for later. 
Encryption sk: 2c21211240cb3e79ed3656f510513efc2aaa7d4f09d958ced92239b7af33c204
Encryption pk: 86de3db3f383379715bdf920768e5a2b9ad102c01de08e9b6009d8848aae8939448603ca0db10525aca5b4c6a270666d

# creator encrypts the master key to the provided encryption key. Outputs the following: 
# 1. prints out encrypted master key 
# 2. output ciphertext to file 
# 3. output obfuscated_nft.png to file

target/debug/enft-cli encrypt -i ./capy.png --master-sk a1466cfa0e01b2b2a40663d18ce5651459444580ac4b3cd36a403ba0a46cb76eda010994c94858edc4811570f8893af4 --enc-pk 86e2dc6d7c0e0ee4744c7625bedfe8462b8e63262f41fa6403316f90a10e69466f53ef4f9dd5bcca9a460b797bfd8892

Encrypted master sk:
"807fe2952817e98573e6e2f65c51dec919aedbc423186419c390053efb0f5aa79464d238cf33748cf6951736b9e13439a4224b87525ed2c0d9dbcbe79fd8c3c4f70976cb1c05b81e926436b3cf7eec14cb4ca33c6a084c27bd4f192ab1cad64b"
Ciphertext written to file.
Obfuscated image to file.

# now creator (seller) initiates transfers. Outputs the following: 
# 1. a new encrypted master key under the buyer pk. 
# 2. a consistency proof to ensure the encryption is indeed for the same master key. 

target/debug/enft-cli transfer --master-sk a1466cfa0e01b2b2a40663d18ce5651459444580ac4b3cd36a403ba0a46cb76eda010994c94858edc4811570f8893af4 --prev-enc-msk 807fe2952817e98573e6e2f65c51dec919aedbc423186419c390053efb0f5aa79464d238cf33748cf6951736b9e13439a4224b87525ed2c0d9dbcbe79fd8c3c4f70976cb1c05b81e926436b3cf7eec14cb4ca33c6a084c27bd4f192ab1cad64b --buyer-pk 86de3db3f383379715bdf920768e5a2b9ad102c01de08e9b6009d8848aae8939448603ca0db10525aca5b4c6a270666d --seller-enc-sk 2fd7a46d6c4955630c91f6960b4cfc02f07254d0f41feccf03f67c3e2f07576f

Serialized newly encrypted master key (under buyer pk):
"b30e4967e3ee4eba110741a3f78359a947444edd6e63573088a09b8a751331a7b555d33e208e8eb7abc42bfec0bda17881518cb5c8bc10c65f5ae12dbf5bf07d556f9a3022e602f08ee562b0ef437d73c4f3031db10cd92ae18cb274a53b3dff"
Serialized consistency proof:
"3e4d8d4ae5a73923f058cf367a11e299a35d59dc45861743a3021f4030d223b92e55e6bfd0034a125d77bf9fa6df600a2897300c37c270844797cec946e001fcaf5b8965d4e55fd8d9f185e668747031fafed94da93bdadf23c60fc27f3a3e14ffe023e5486e4abe3460ec1348bdf965b4d3c7ca9c6caf6dda355e82efc92dfa0d1fe390c68a810f3b8675ecaf9a092e3741a9908aa07fc59ed6ee37c84109fd8f9be5cb7a4f0a07ef9a2cbb845a1849427ba3c7fe2b6923fb0155fdf3544cae8bee9a4f873af3ea7f1666dfd2365dad"

# Offchain verify the consistency proof. This happens onchain when the seller takes the payment. 

target/debug/enft-cli verify --serialized-proof 3e4d8d4ae5a73923f058cf367a11e299a35d59dc45861743a3021f4030d223b92e55e6bfd0034a125d77bf9fa6df600a2897300c37c270844797cec946e001fcaf5b8965d4e55fd8d9f185e668747031fafed94da93bdadf23c60fc27f3a3e14ffe023e5486e4abe3460ec1348bdf965b4d3c7ca9c6caf6dda355e82efc92dfa0d1fe390c68a810f3b8675ecaf9a092e3741a9908aa07fc59ed6ee37c84109fd8f9be5cb7a4f0a07ef9a2cbb845a1849427ba3c7fe2b6923fb0155fdf3544cae8bee9a4f873af3ea7f1666dfd2365dad --prev-enc-msk 807fe2952817e98573e6e2f65c51dec919aedbc423186419c390053efb0f5aa79464d238cf33748cf6951736b9e13439a4224b87525ed2c0d9dbcbe79fd8c3c4f70976cb1c05b81e926436b3cf7eec14cb4ca33c6a084c27bd4f192ab1cad64b --curr-enc-msk b30e4967e3ee4eba110741a3f78359a947444edd6e63573088a09b8a751331a7b555d33e208e8eb7abc42bfec0bda17881518cb5c8bc10c65f5ae12dbf5bf07d556f9a3022e602f08ee562b0ef437d73c4f3031db10cd92ae18cb274a53b3dff --seller-enc-pk 86e2dc6d7c0e0ee4744c7625bedfe8462b8e63262f41fa6403316f90a10e69466f53ef4f9dd5bcca9a460b797bfd8892 --buyer-enc-pk 86de3db3f383379715bdf920768e5a2b9ad102c01de08e9b6009d8848aae8939448603ca0db10525aca5b4c6a270666d

# buyer now has the ciphertext and the encrypted master key from onchain. He also already have buyer_sk. 

target/debug/enft-cli decrypt --enc-master-sk b30e4967e3ee4eba110741a3f78359a947444edd6e63573088a09b8a751331a7b555d33e208e8eb7abc42bfec0bda17881518cb5c8bc10c65f5ae12dbf5bf07d556f9a3022e602f08ee562b0ef437d73c4f3031db10cd92ae18cb274a53b3dff --ciphertext-path ./ciphertext --buyer-sk 2c21211240cb3e79ed3656f510513efc2aaa7d4f09d958ced92239b7af33c204

Recovered master sk: "a1466cfa0e01b2b2a40663d18ce5651459444580ac4b3cd36a403ba0a46cb76eda010994c94858edc4811570f8893af4"
Original nft saved to original_nft.png. This is identical with capy.png
```