# CLI

```
cd cli/
cargo build --release
target/release/enft-cli -h

# creator generates msk

target/release/enft-cli generate-master-key

Master sk: a1466cfa0e01b2b2a40663d18ce5651459444580ac4b3cd36a403ba0a46cb76eda010994c94858edc4811570f8893af4

# creator generates encryption key (AES key)

target/release/enft-cli generate-encryption-key

Encryption sk: 2fd7a46d6c4955630c91f6960b4cfc02f07254d0f41feccf03f67c3e2f07576f
Encryption pk: 86e2dc6d7c0e0ee4744c7625bedfe8462b8e63262f41fa6403316f90a10e69466f53ef4f9dd5bcca9a460b797bfd8892

# generate another pair, assume this is for buyer for later. 
Encryption sk: 2c21211240cb3e79ed3656f510513efc2aaa7d4f09d958ced92239b7af33c204
Encryption pk: 86de3db3f383379715bdf920768e5a2b9ad102c01de08e9b6009d8848aae8939448603ca0db10525aca5b4c6a270666d

# creator encrypts the master key to the provided encryption key. Outputs the following: 
# 1. prints out encrypted master key 
# 2. output ciphertext to file 
# 3. output obfuscated_nft.png to file

target/release/enft-cli encrypt -i ./capy.png --master-sk a1466cfa0e01b2b2a40663d18ce5651459444580ac4b3cd36a403ba0a46cb76eda010994c94858edc4811570f8893af4 --enc-pk 86e2dc6d7c0e0ee4744c7625bedfe8462b8e63262f41fa6403316f90a10e69466f53ef4f9dd5bcca9a460b797bfd8892

Encrypted master sk:
"83e35898f61711f28aee79c36f01c2f09db2629ea93cca2cca4243dfd5f6b1796a538f340fecca4a34942a7da11c8b6fae6644a47b891c9c04df63565e54b06207c9fcae0478a54a07e42e800eb0ee6df1efd3ce26c3471e1699597787727779"
Ciphertext written to file.
Obfuscated image to file.

# now creator (seller) initiates transfers. Outputs the following: 
# 1. a new encrypted master key under the buyer pk. 
# 2. a consistency proof to ensure the encryption is indeed for the same master key. 
# Note that the encrypted msk and the proof changes since it takes into account a randomness. 

target/release/enft-cli transfer --master-sk a1466cfa0e01b2b2a40663d18ce5651459444580ac4b3cd36a403ba0a46cb76eda010994c94858edc4811570f8893af4 --prev-enc-msk 83e35898f61711f28aee79c36f01c2f09db2629ea93cca2cca4243dfd5f6b1796a538f340fecca4a34942a7da11c8b6fae6644a47b891c9c04df63565e54b06207c9fcae0478a54a07e42e800eb0ee6df1efd3ce26c3471e1699597787727779 --buyer-pk 86de3db3f383379715bdf920768e5a2b9ad102c01de08e9b6009d8848aae8939448603ca0db10525aca5b4c6a270666d --seller-enc-sk 2fd7a46d6c4955630c91f6960b4cfc02f07254d0f41feccf03f67c3e2f07576f

Serialized newly encrypted master key (under buyer pk):
"b5222036738cbd5d3271f6f67a6a76a8747792891e777349bee13990e729ac5f4efb678434b1b26a00f485e68232eeef82ffb1c939387d848d79c7b428840c534c2f500d8f80e853c27d3f1a6f3ba8b917890adeb3f69913007c5b98cf8d87b2"
Serialized equality proof:
"0df498b308b3970764d58d3a28f9f8ce00a125cf8aaf29148807366b1e791aa55f1fba976ce92c480fcd1c320c7a826385c4eba8c4341a1997248481401ca1e4b4a5977fba3747a613e3f33766b39e4bdeedea5fdf2940ee7175366f3bdbe01392ff7a48f178661bb9476d751e401c8a8cb732b421173783048ab5b073eb5c3d50929191aa31e923837c8aa39401d93e8b6273eebd79563f5a9f177d94b379f4a9605fa55447eb5c324176c0f91e8357f8f345e239bf3e25230773d577387b6c6f7aa29937a484464e2de8c8289e6bb3"

# Offchain verify the consistency proof. This happens onchain when the seller takes the payment. 

target/release/enft-cli verify --serialized-proof 0df498b308b3970764d58d3a28f9f8ce00a125cf8aaf29148807366b1e791aa55f1fba976ce92c480fcd1c320c7a826385c4eba8c4341a1997248481401ca1e4b4a5977fba3747a613e3f33766b39e4bdeedea5fdf2940ee7175366f3bdbe01392ff7a48f178661bb9476d751e401c8a8cb732b421173783048ab5b073eb5c3d50929191aa31e923837c8aa39401d93e8b6273eebd79563f5a9f177d94b379f4a9605fa55447eb5c324176c0f91e8357f8f345e239bf3e25230773d577387b6c6f7aa29937a484464e2de8c8289e6bb3 --prev-enc-msk 83e35898f61711f28aee79c36f01c2f09db2629ea93cca2cca4243dfd5f6b1796a538f340fecca4a34942a7da11c8b6fae6644a47b891c9c04df63565e54b06207c9fcae0478a54a07e42e800eb0ee6df1efd3ce26c3471e1699597787727779 --curr-enc-msk b5222036738cbd5d3271f6f67a6a76a8747792891e777349bee13990e729ac5f4efb678434b1b26a00f485e68232eeef82ffb1c939387d848d79c7b428840c534c2f500d8f80e853c27d3f1a6f3ba8b917890adeb3f69913007c5b98cf8d87b2 --seller-enc-pk 86e2dc6d7c0e0ee4744c7625bedfe8462b8e63262f41fa6403316f90a10e69466f53ef4f9dd5bcca9a460b797bfd8892 --buyer-enc-pk 86de3db3f383379715bdf920768e5a2b9ad102c01de08e9b6009d8848aae8939448603ca0db10525aca5b4c6a270666d

# buyer now has the ciphertext and the encrypted master key from onchain. He also already have buyer_sk. 

target/release/enft-cli decrypt --enc-master-sk b5222036738cbd5d3271f6f67a6a76a8747792891e777349bee13990e729ac5f4efb678434b1b26a00f485e68232eeef82ffb1c939387d848d79c7b428840c534c2f500d8f80e853c27d3f1a6f3ba8b917890adeb3f69913007c5b98cf8d87b2 --ciphertext-path ./ciphertext --buyer-sk 2c21211240cb3e79ed3656f510513efc2aaa7d4f09d958ced92239b7af33c204

Recovered master sk: "a1466cfa0e01b2b2a40663d18ce5651459444580ac4b3cd36a403ba0a46cb76eda010994c94858edc4811570f8893af4"
Original nft saved to original_nft.png. This is identical with capy.png
```