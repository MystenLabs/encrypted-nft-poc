# CLI

```
cd cli/
cargo build --bin enft-cli
target/debug/enft-cli -h

# creator generates msk

target/debug/enft-cli generate-master-key

Master sk: a1466cfa0e01b2b2a40663d18ce5651459444580ac4b3cd36a403ba0a46cb76eda010994c94858edc4811570f8893af4

# creator generates encryption key (AES key)

target/debug/enft-cli generate-encryption-key

Encryption sk: 2fd7a46d6c4955630c91f6960b4cfc02f07254d0f41feccf03f67c3e2f07576f
Encryption pk: 86e2dc6d7c0e0ee4744c7625bedfe8462b8e63262f41fa6403316f90a10e69466f53ef4f9dd5bcca9a460b797bfd8892

# generate another pair, assume this is for buyer for later. 
Encryption sk: 2c21211240cb3e79ed3656f510513efc2aaa7d4f09d958ced92239b7af33c204
Encryption pk: 86de3db3f383379715bdf920768e5a2b9ad102c01de08e9b6009d8848aae8939448603ca0db10525aca5b4c6a270666d

# creator encrypts the master key to the provided encryption key. Outputs the following: 
# 1. prints out encrypted master key 
# 2. output ciphertext to file 
# 3. output obfuscated_nft.png to file

target/debug/enft-cli encrypt -i ./capy.png --master-sk a1466cfa0e01b2b2a40663d18ce5651459444580ac4b3cd36a403ba0a46cb76eda010994c94858edc4811570f8893af4 --enc-pk 86e2dc6d7c0e0ee4744c7625bedfe8462b8e63262f41fa6403316f90a10e69466f53ef4f9dd5bcca9a460b797bfd8892

Encrypted master sk:
"8c5ca81f52fe6cd32e46393544cf22686990981b94e572a523158fdb570191d8ada860daf4f1a1f6d0c35c0946b30284ac446dbef3fd6907bd812289d806747348f7cfbfd2c5854f2236bcb6a495ac94280d32aae33264f811d708d7f94c10fa"
Ciphertext written to file.
Obfuscated image to file.

# now creator (seller) initiates transfers. Outputs the following: 
# 1. a new encrypted master key under the buyer pk. 
# 2. a consistency proof to ensure the encryption is indeed for the same master key. 
# Note that the encrypted msk and the proof changes since it takes into account a randomness. 

target/debug/enft-cli transfer --master-sk a1466cfa0e01b2b2a40663d18ce5651459444580ac4b3cd36a403ba0a46cb76eda010994c94858edc4811570f8893af4 --prev-enc-msk 8c5ca81f52fe6cd32e46393544cf22686990981b94e572a523158fdb570191d8ada860daf4f1a1f6d0c35c0946b30284ac446dbef3fd6907bd812289d806747348f7cfbfd2c5854f2236bcb6a495ac94280d32aae33264f811d708d7f94c10fa --buyer-pk 86de3db3f383379715bdf920768e5a2b9ad102c01de08e9b6009d8848aae8939448603ca0db10525aca5b4c6a270666d --seller-enc-sk 2fd7a46d6c4955630c91f6960b4cfc02f07254d0f41feccf03f67c3e2f07576f

Serialized newly encrypted master key (under buyer pk):
"a6b1ada2c6a1f5d04ba4b3b08e01167c241ac79a9011e5f4b487106dc0c4771629723da729367c8b7fdaf4dba7702a0d93b26c10b5acae52c0b00d33bdfafdf5043d5acebc3da062359752df3217dad4e9bbb9a3d99d68257bb046bec204dff0"
Serialized equality proof:
"04d8196dc4a95ddf8cfc075275162d8218ed2a731589840ae229518bed07a6ea66dc3b2cfe92ece181003383cc4ae87ded5998714c8f8e48dfb65b6f30d3958288827e0626c3d36fd1cd186dee62fa60c7c7b911da7a68d645f87cd9ca6e420d2029e47854ff84fd355e42a84bc5da89a2b8da847f5af0ab224fb6379ec6ab8d9001e3ba2dc5f335e67bc2df6170e4383faa6be5938a1ffe26d47706db5e2c6698df5a2cc58a9cb20d006b792752b833c6a1cff82258503bb28cf93de1f3d3e379bb7c402d334cd7224a31239bc1841a"

# Offchain verify the consistency proof. This happens onchain when the seller takes the payment. 

target/debug/enft-cli verify --serialized-proof 04d8196dc4a95ddf8cfc075275162d8218ed2a731589840ae229518bed07a6ea66dc3b2cfe92ece181003383cc4ae87ded5998714c8f8e48dfb65b6f30d3958288827e0626c3d36fd1cd186dee62fa60c7c7b911da7a68d645f87cd9ca6e420d2029e47854ff84fd355e42a84bc5da89a2b8da847f5af0ab224fb6379ec6ab8d9001e3ba2dc5f335e67bc2df6170e4383faa6be5938a1ffe26d47706db5e2c6698df5a2cc58a9cb20d006b792752b833c6a1cff82258503bb28cf93de1f3d3e379bb7c402d334cd7224a31239bc1841a --prev-enc-msk 8c5ca81f52fe6cd32e46393544cf22686990981b94e572a523158fdb570191d8ada860daf4f1a1f6d0c35c0946b30284ac446dbef3fd6907bd812289d806747348f7cfbfd2c5854f2236bcb6a495ac94280d32aae33264f811d708d7f94c10fa --curr-enc-msk a6b1ada2c6a1f5d04ba4b3b08e01167c241ac79a9011e5f4b487106dc0c4771629723da729367c8b7fdaf4dba7702a0d93b26c10b5acae52c0b00d33bdfafdf5043d5acebc3da062359752df3217dad4e9bbb9a3d99d68257bb046bec204dff0 --seller-enc-pk 86e2dc6d7c0e0ee4744c7625bedfe8462b8e63262f41fa6403316f90a10e69466f53ef4f9dd5bcca9a460b797bfd8892 --buyer-enc-pk 86de3db3f383379715bdf920768e5a2b9ad102c01de08e9b6009d8848aae8939448603ca0db10525aca5b4c6a270666d

# buyer now has the ciphertext and the encrypted master key from onchain. He also already have buyer_sk. 

target/debug/enft-cli decrypt --enc-master-sk a6b1ada2c6a1f5d04ba4b3b08e01167c241ac79a9011e5f4b487106dc0c4771629723da729367c8b7fdaf4dba7702a0d93b26c10b5acae52c0b00d33bdfafdf5043d5acebc3da062359752df3217dad4e9bbb9a3d99d68257bb046bec204dff0 --ciphertext-path ./ciphertext --buyer-sk 2c21211240cb3e79ed3656f510513efc2aaa7d4f09d958ced92239b7af33c204

Recovered master sk: "a1466cfa0e01b2b2a40663d18ce5651459444580ac4b3cd36a403ba0a46cb76eda010994c94858edc4811570f8893af4"
Original nft saved to original_nft.png. This is identical with capy.png
```